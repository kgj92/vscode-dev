<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>uniq 커뮤니티</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .post { border: 1px solid #ccc; padding: 15px; margin: 10px 0; border-radius: 8px; }
    input, textarea { display: block; margin: 10px 0; padding: 10px; width: 100%; max-width: 500px; }
    button { padding: 10px 20px; cursor: pointer; }
    .tab-pane { display: none; }
    .tab-pane.active { display: block; }
    .tab-list li { display: inline; margin-right: 15px; cursor: pointer; }
    .tab-item.active a { font-weight: bold; }
  </style>
</head>
<body>

  <!-- 헤더 영역 -->
  <header>
    <div class="header-left">
      <button class="menu-btn">메뉴</button>
    </div>
    <div class="header-center">
      <a href="#" class="logo">uniq</a>
    </div>
    <div class="header-right">
      <a href="#" id="login-btn" class="btn">로그인</a>
    </div>
  </header>

  <!-- 탭 메뉴 -->
  <div class="tabs">
    <ul class="tab-list">
      <li class="tab-item active" data-tab="new-posts"><a href="#">NEW</a></li>
      <li class="tab-item" data-tab="real-time-popular"><a href="#">실시간 인기글</a></li>
      <li class="tab-item" data-tab="weekly-popular"><a href="#">주간 인기글</a></li>
      <li class="tab-item" data-tab="write-post"><a href="#">글쓰기</a></li>
    </ul>
  </div>

  <!-- 탭 내용 -->
  <div class="tab-content">
    <div id="new-posts" class="tab-pane active">
      <h2>최신 글</h2>
      <div id="postList"></div>
      <button onclick="loadPosts()">글 불러오기</button>
    </div>
    <div id="real-time-popular" class="tab-pane">
      <p>실시간 인기글 표시 예정</p>
    </div>
    <div id="weekly-popular" class="tab-pane">
      <p>주간 인기글 표시 예정</p>
    </div>
    <div id="write-post" class="tab-pane">
      <h2>글쓰기</h2>
      <form id="postForm">
        <input type="text" id="post_title" placeholder="제목" required />
        <textarea id="post_content" placeholder="내용" required></textarea>
        <input type="text" id="post_author" placeholder="작성자" required />
        <button type="submit">글 등록</button>
      </form>
    </div>
  </div>

  <script>
    const serverURL = "https://vscode-dev-1.onrender.com"; // Render 서버 주소로 변경하세요

    // 탭 전환 로직
    document.querySelectorAll(".tab-item").forEach(tab => {
      tab.addEventListener("click", function (e) {
        e.preventDefault();
        document.querySelectorAll(".tab-item").forEach(t => t.classList.remove("active"));
        document.querySelectorAll(".tab-pane").forEach(p => p.classList.remove("active"));

        this.classList.add("active");
        document.getElementById(this.dataset.tab).classList.add("active");
      });
    });

    // 글쓰기 제출
    document.getElementById("postForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const title = document.getElementById("post_title").value;
      const content = document.getElementById("post_content").value;
      const author = document.getElementById("post_author").value;

      const res = await fetch(`${serverURL}/write`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ title, content, author })
      });

      const data = await res.json();
      alert(data.msg || "글이 등록되었습니다.");
      document.getElementById("postForm").reset();
    });

    // 글 불러오기
    async function loadPosts() {
      const res = await fetch(`${serverURL}/posts`);
      const posts = await res.json();
      const container = document.getElementById("postList");
      container.innerHTML = "";

      posts.forEach(post => {
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `
          <h3>${post.title}</h3>
          <p>${post.content}</p>
          <small>작성자: ${post.author} | 날짜: ${new Date(post.createdAt).toLocaleString()}</small>
        `;
        container.appendChild(div);
      });
    }

    // 페이지 로드 시 자동 실행 (선택)
    window.onload = loadPosts;
  </script>
</body>
</html>
